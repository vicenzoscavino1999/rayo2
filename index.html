<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <title>Scriba - ¿Qué está pasando?</title>

    <!-- PWA Configuration -->
    <meta name="theme-color" content="#030303">
    <meta name="description" content="Red social en tiempo real - Únete a la conversación">
    <link rel="manifest" href="/manifest.json">

    <!-- iOS PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Scriba">
    <link rel="apple-touch-icon" href="/icon-192.png">
    <link rel="apple-touch-startup-image" href="/icon-512.png">

    <link rel="stylesheet" href="style.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-top">
                <div class="logo sidebar-logo">
                    <img src="/scriba-logo.png" alt="Scriba" class="sidebar-logo-img">
                </div>
                <nav class="nav-menu">
                    <a href="#" class="nav-item active" id="nav-home"><i data-lucide="home"></i> <span
                            class="nav-text">Inicio</span></a>
                    <a href="#" class="nav-item" onclick="showExplore(); return false;"><i data-lucide="search"></i>
                        <span class="nav-text">Explorar</span></a>
                    <a href="#" class="nav-item position-relative" onclick="showNotifications(); return false;">
                        <i data-lucide="bell"></i>
                        <span class="nav-text">Notificaciones</span>
                        <span class="badge" id="notification-badge" style="display:none;"></span>
                    </a>
                    <a href="messages.html" class="nav-item" id="nav-messages"><i data-lucide="mail"></i> <span
                            class="nav-text">Mensajes</span></a>
                    <a href="#" class="nav-item" id="nav-profile"><i data-lucide="user"></i> <span
                            class="nav-text">Perfil</span></a>
                    <a href="#" class="nav-item" id="nav-logout"><i data-lucide="log-out"></i> <span
                            class="nav-text">Salir</span></a>
                </nav>
                <button class="btn-publish-large" id="btn-publish-modal">Publicar</button>
                <button class="btn-publish-fab" id="btn-publish-fab"><i data-lucide="feather"></i></button>
            </div>
            <div class="sidebar-bottom">
                <div class="user-profile-mini" id="user-profile-mini">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="User Avatar"
                        class="avatar-mini" id="sidebar-avatar">
                    <div class="user-info-mini">
                        <span class="user-name" id="sidebar-name">Usuario</span>
                        <span class="user-handle" id="sidebar-handle">@usuario_rayo</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Feed -->
        <main class="main-feed">
            <header class="feed-header">
                <div class="feed-tabs">
                    <div class="tab active" data-tab="para-ti">Para ti</div>
                    <div class="tab" data-tab="siguiendo">Siguiendo</div>
                </div>
                <div class="header-settings">
                    <button class="btn-icon" aria-label="Configuración">
                        <i data-lucide="settings"></i>
                    </button>
                </div>
            </header>

            <!-- Composer -->
            <section class="composer">
                <div class="composer-layout">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="User Avatar"
                        class="avatar-small" id="composer-avatar">
                    <div class="composer-content">
                        <textarea placeholder="¿Qué está pasando?" id="post-textarea"></textarea>
                        <div class="composer-actions">
                            <div class="action-icons">
                                <button class="btn-icon" id="composer-image-btn" aria-label="Agregar imagen o video">
                                    <i data-lucide="image"></i>
                                </button>
                                <button class="btn-icon" id="composer-emoji-btn" aria-label="Agregar emoji">
                                    <i data-lucide="smile"></i>
                                </button>
                                <button class="btn-icon" id="composer-location-btn" aria-label="Agregar ubicación">
                                    <i data-lucide="map-pin"></i>
                                </button>
                            </div>
                            <button class="btn-primary" id="btn-post" disabled>Publicar</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Posts List -->
            <div id="posts-container">
                <!-- Skeleton loaders shown while loading -->
                <div class="skeleton-post" id="skeleton-loader-1">
                    <div class="skeleton-header">
                        <div class="skeleton skeleton-avatar"></div>
                        <div style="flex:1">
                            <div class="skeleton skeleton-name"></div>
                            <div class="skeleton skeleton-handle" style="margin-top:4px"></div>
                        </div>
                    </div>
                    <div class="skeleton-content">
                        <div class="skeleton skeleton-line"></div>
                        <div class="skeleton skeleton-line"></div>
                        <div class="skeleton skeleton-line"></div>
                    </div>
                </div>
                <div class="skeleton-post" id="skeleton-loader-2">
                    <div class="skeleton-header">
                        <div class="skeleton skeleton-avatar"></div>
                        <div style="flex:1">
                            <div class="skeleton skeleton-name"></div>
                            <div class="skeleton skeleton-handle" style="margin-top:4px"></div>
                        </div>
                    </div>
                    <div class="skeleton-content">
                        <div class="skeleton skeleton-line"></div>
                        <div class="skeleton skeleton-line"></div>
                    </div>
                </div>
                <div class="skeleton-post" id="skeleton-loader-3">
                    <div class="skeleton-header">
                        <div class="skeleton skeleton-avatar"></div>
                        <div style="flex:1">
                            <div class="skeleton skeleton-name"></div>
                            <div class="skeleton skeleton-handle" style="margin-top:4px"></div>
                        </div>
                    </div>
                    <div class="skeleton-content">
                        <div class="skeleton skeleton-line"></div>
                        <div class="skeleton skeleton-line"></div>
                        <div class="skeleton skeleton-line"></div>
                    </div>
                </div>
            </div>

            <div class="infinite-scroll-loader" id="loader" style="display: none;">
                <div class="loader-spinner"></div>
            </div>
        </main>

        <!-- Right Sidebar (Extras) -->
        <aside class="extras">
            <div class="search-bar">
                <i data-lucide="search"></i>
                <input type="text" placeholder="Buscar en Rayo" id="search-input">
            </div>

            <div class="extra-card">
                <h3>Qué está pasando</h3>
                <div class="trend-item">
                    <span class="trend-meta">Tendencia en Tecnología</span>
                    <span class="trend-name">#RayoReact</span>
                    <span class="trend-count">12.5K posts</span>
                </div>
                <div class="trend-item">
                    <span class="trend-meta">Deportes · Hace 2 horas</span>
                    <span class="trend-name">Messi</span>
                    <span class="trend-count">85K posts</span>
                </div>
                <a href="#" class="show-more">Mostrar más</a>
            </div>

            <div class="extra-card">
                <h3>A quién seguir</h3>
                <div class="follow-item">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=David" alt="Avatar" class="avatar-small">
                    <div class="follow-info">
                        <span class="follow-name">David Dev</span>
                        <span class="follow-handle">@david_ui</span>
                    </div>
                    <button class="btn-follow">Seguir</button>
                </div>
                <a href="#" class="show-more">Mostrar más</a>
            </div>
        </aside>
    </div>

    <!-- Post Modal -->
    <div class="modal-overlay" id="modal-overlay" role="dialog" aria-modal="true" aria-labelledby="post-modal-title">
        <div class="modal-content">
            <div class="modal-header">
                <span id="post-modal-title" class="visually-hidden">Crear nueva publicación</span>
                <button class="modal-close" id="modal-close" aria-label="Cerrar modal"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body">
                <div class="composer-layout">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="User Avatar"
                        class="avatar-small" id="modal-avatar">
                    <div class="composer-content">
                        <textarea placeholder="¿Qué está pasando?" id="modal-textarea"></textarea>
                        <div class="composer-actions">
                            <div class="action-icons">
                                <button class="btn-icon" id="modal-image-btn" aria-label="Agregar imagen o video"
                                    type="button">
                                    <i data-lucide="image"></i>
                                </button>
                                <button class="btn-icon" id="modal-emoji-btn" aria-label="Agregar emoji" type="button">
                                    <i data-lucide="smile"></i>
                                </button>
                                <button class="btn-icon" id="modal-schedule-btn" aria-label="Programar publicación"
                                    type="button">
                                    <i data-lucide="calendar"></i>
                                </button>
                                <button class="btn-icon" id="modal-location-btn" aria-label="Agregar ubicación"
                                    type="button">
                                    <i data-lucide="map-pin"></i>
                                </button>
                            </div>
                            <button class="btn-primary" id="modal-post-btn" disabled>Publicar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Comment Modal -->
    <div class="modal-overlay comment-modal" id="comment-modal-overlay" role="dialog" aria-modal="true"
        aria-labelledby="comment-modal-title">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <button class="modal-close" id="comment-modal-close" aria-label="Cerrar modal"><i
                        data-lucide="x"></i></button>
                <span class="modal-title" id="comment-modal-title">Respuestas</span>
            </div>
            <div class="modal-body comment-modal-body">
                <div id="comment-post-container" class="comment-post-container">
                    <!-- Original post will be rendered here -->
                </div>
                <div class="comments-divider"></div>
                <div id="comments-container" class="comments-container">
                    <!-- Comments will be rendered here -->
                </div>
                <div class="comment-composer">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="User Avatar"
                        class="avatar-tiny" id="comment-avatar">
                    <div class="comment-input-wrapper">
                        <textarea placeholder="Escribe tu respuesta..." id="comment-textarea"></textarea>
                        <button class="btn-primary btn-small" id="comment-post-btn" disabled>Responder</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Bottom Navigation -->
    <nav class="mobile-nav" id="mobile-nav">
        <div class="mobile-nav-items">
            <a href="#" class="mobile-nav-item active" id="mobile-nav-home">
                <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z" />
                    <polyline points="9 22 9 12 15 12 15 22" />
                </svg>
            </a>
            <a href="#" class="mobile-nav-item" id="mobile-nav-explore">
                <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8" />
                    <path d="m21 21-4.3-4.3" />
                </svg>
            </a>
            <a href="messages.html" class="mobile-nav-item" id="mobile-nav-messages">
                <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect width="20" height="16" x="2" y="4" rx="2" />
                    <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7" />
                </svg>
            </a>
            <a href="#" class="mobile-nav-item" id="mobile-nav-notifications">
                <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9" />
                    <path d="M10.3 21a1.94 1.94 0 0 0 3.4 0" />
                </svg>
                <span class="mobile-nav-badge" id="mobile-notification-badge" style="display:none;"></span>
            </a>
            <a href="#" class="mobile-nav-item" id="mobile-nav-profile">
                <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="8" r="5" />
                    <path d="M20 21a8 8 0 0 0-16 0" />
                </svg>
            </a>
        </div>
    </nav>

    <script type="module" src="app.js"></script>

    <!-- PWA Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then(reg => console.log('✅ Service Worker registered'))
                    .catch(err => console.log('❌ Service Worker registration failed:', err));
            });
        }
    </script>
</body>

</html>